<html>
    <head>
        <link rel="stylesheet" type="text/css" href="css/ui-darkness/jquery-ui-1.8.2.custom.css" />
        <script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>
        <script type="text/javascript" src="js/jquery-ui-1.8.2.custom.min.js"></script>
        <style>
            body {
                background: #111;
            }
            div.item {
                padding: 10px;
            }
        </style>
    </head>

    <body>
        <div id="player" style="display: none;"></div>
        <script>
            var start_point = '.';

            function full_url(prefix, filename)
            {
                return prefix + encodeURI(filename);
            }

            function activate_file(prefix, filename)
            {
                $('body').append('video');
                $('#player').html('<video src="' + full_url(prefix, filename) + '" autoplay controls>');
                $('#player').delay(800).slideDown(400);
            }
            function activate_dir(prefix, filename)
            {
            }

            $(function() {
                $.getJSON('myapp://list_files', function(data) {
                    var prefix = data['prefix'];
                    var files = data['files'];
                    for(var i = 0; i < files.length; i++)
                    {
                        var css_classes = 'ui-widget-header item';
                        if(i == 3)
                            css_classes += ' ui-state-active';

                        var onclick = files[i]['type'] == 'directory' ? 'activate_dir' : 'activate_file';

                        $('body').append(
                            '<div id="one" class="' + css_classes + '">' +
                                '<a href="#" onclick="' + onclick + '(\'' + prefix + '\', \'' + files[i]['filename'] + '\');">' +
                                    files[i]['filename'] +
                                '</a>' +
                            '</div>'
                        );
                    }
                });
            });
        </script>
    </body>
</html>
