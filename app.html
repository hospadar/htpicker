<html>
    <head>
        <link rel="stylesheet" type="text/css" href="css/ui-darkness/jquery-ui-1.8.2.custom.css" />
        <script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>
        <script type="text/javascript" src="js/jquery-ui-1.8.2.custom.min.js"></script>
        <style>
            * { font-family: 'Droid Sans', sans-serif; font-size: xx-large; }
            body { background: #111; }
            div.item { padding: 10px; }
            div.item a:link,
            div.item a:active,
            div.item a:hover,
            div.item a:visited { text-decoration: none; }
        </style>
    </head>

    <body>
        <div id="player" style="display: none;"></div>
        <script>
            var start_point = '.';
            var have_video = false;

            function full_url(prefix, filename)
            {
                return prefix + encodeURI(filename);
            }

            function activate_file(prefix, filename)
            {
                var player = $('#player');
                if(!have_video)
                {
                    player.html('<video height="33%" width="50%" src="' + full_url(prefix, filename) + '" autoplay>');
                    player.slideDown('fast');
                    have_video = true;
                }
                else
                {
                    $('#player > video')[0].pause();
                    player.fadeOut('fast');
                    player.html('<video height="33%" width="50%" src="' + full_url(prefix, filename) + '" autoplay>');
                    $('#player > video')[0].play();
                    player.fadeIn('slow');
                }
            }
            function activate_dir(prefix, filename)
            {
            }

            $(function() {
                $.getJSON('myapp://list_files', function(data) {
                    var prefix = data['prefix'];
                    var files = data['files'];
                    for(var i = 0; i < files.length; i++)
                    {
                        var css_classes = 'ui-widget-header item';
                        if(i == 3)
                            css_classes += ' ui-state-active';

                        var onclick = files[i]['type'] == 'directory' ? 'activate_dir' : 'activate_file';

                        $('body').append(
                            '<div id="one" class="' + css_classes + '">' +
                                '<a href="#" onclick="' + onclick + '(\'' + prefix + '\', \'' + files[i]['filename'] + '\');">' +
                                    files[i]['filename'] +
                                '</a>' +
                            '</div>'
                        );
                    }
                });
            });
        </script>
    </body>
</html>
